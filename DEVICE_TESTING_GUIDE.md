# 设备测试指南

本文档提供了在不同设备和屏幕尺寸上测试时间记录APP的指南。

## 测试设备配置

### 1. 手机 - 竖屏模式
- **分辨率**: 360dp x 640dp
- **DPI**: 480
- **窗口大小类**: COMPACT
- **测试重点**:
  - 主页活动卡片应显示为 2 列网格
  - 计时器页面使用垂直布局
  - 所有按钮和卡片触摸目标 ≥ 48dp

### 2. 手机 - 横屏模式
- **分辨率**: 640dp x 360dp
- **DPI**: 480
- **窗口大小类**: MEDIUM
- **测试重点**:
  - 主页活动卡片应显示为 3 列网格
  - 计时器页面使用水平布局（左侧显示计时器，右侧显示按钮）
  - 内容不应被截断

### 3. 小平板 - 竖屏模式
- **分辨率**: 600dp x 960dp
- **DPI**: 240
- **窗口大小类**: MEDIUM
- **测试重点**:
  - 主页活动卡片应显示为 3 列网格
  - 统计页面热力图应清晰可见
  - 文字大小适中，易于阅读

### 4. 小平板 - 横屏模式
- **分辨率**: 960dp x 600dp
- **DPI**: 240
- **窗口大小类**: MEDIUM
- **测试重点**:
  - 主页活动卡片应显示为 3 列网格
  - 计时器页面使用水平布局
  - 充分利用屏幕空间

### 5. 大平板 - 竖屏模式
- **分辨率**: 840dp x 1280dp
- **DPI**: 240
- **窗口大小类**: EXPANDED
- **测试重点**:
  - 主页活动卡片应显示为 4 列网格
  - 统计页面应充分利用大屏幕空间
  - 内容不应过于分散

### 6. 大平板 - 横屏模式
- **分辨率**: 1280dp x 840dp
- **DPI**: 240
- **窗口大小类**: EXPANDED
- **测试重点**:
  - 主页活动卡片应显示为 4 列网格
  - 计时器页面使用水平布局
  - 最佳的屏幕空间利用

## 测试步骤

### 在 Android Studio 中测试

1. **使用预览功能**:
   ```kotlin
   @PhonePortraitPreview
   @PhoneLandscapePreview
   @SmallTabletPortraitPreview
   @SmallTabletLandscapePreview
   @LargeTabletPortraitPreview
   @LargeTabletLandscapePreview
   @Composable
   fun YourScreenPreview() {
       // Your screen composable
   }
   ```

2. **使用模拟器**:
   - 打开 AVD Manager
   - 创建不同尺寸的虚拟设备
   - 在每个设备上运行应用
   - 测试横竖屏切换

3. **使用真实设备**:
   - 连接不同尺寸的真实设备
   - 在每个设备上安装并测试应用
   - 验证触摸响应和视觉效果

### 功能测试清单

#### 主页 (HomeScreen)
- [ ] 活动卡片网格正确显示（根据屏幕尺寸显示 2/3/4 列）
- [ ] 卡片大小合适，不会太小或太大
- [ ] 长按卡片显示删除对话框
- [ ] 点击卡片正确导航到计时器页面
- [ ] FloatingActionButton 位置合适，易于点击
- [ ] 横竖屏切换时状态保持

#### 计时器页面 (TimerScreen)
- [ ] 竖屏模式：垂直布局，元素居中
- [ ] 横屏模式：水平布局，左右分布
- [ ] 计时器数字清晰可见，大小合适
- [ ] 暂停/继续按钮大小 ≥ 80dp
- [ ] 完成按钮大小 ≥ 80dp
- [ ] 按钮间距合适，不会误触
- [ ] 背景颜色正确显示活动颜色
- [ ] 横竖屏切换时计时器状态保持

#### 统计页面 (StatisticsScreen)
- [ ] 标签栏（年/月/日）清晰可见
- [ ] 活动筛选下拉菜单正常工作
- [ ] 年度热力图在所有设备上清晰显示
- [ ] 月度日历网格布局合理
- [ ] 日度记录列表滚动流畅
- [ ] 横竖屏切换时视图状态保持

### 触摸目标验证

所有交互元素必须满足以下要求：

- **最小触摸目标**: 48dp x 48dp（Material Design 要求）
- **推荐触摸目标**: 56dp x 56dp（更好的可访问性）

#### 需要验证的元素：
- [ ] 活动卡片（整个卡片可点击）
- [ ] FloatingActionButton（56dp）
- [ ] 计时器暂停/继续按钮（80dp）
- [ ] 计时器完成按钮（80dp）
- [ ] 标签栏按钮（默认 Material 3 尺寸）
- [ ] 下拉菜单项（默认 Material 3 尺寸）
- [ ] 对话框按钮（默认 Material 3 尺寸）

### 性能测试

- [ ] 页面切换流畅，无卡顿
- [ ] 列表滚动流畅（60fps）
- [ ] 计时器每秒更新准确
- [ ] 横竖屏切换响应快速（< 300ms）
- [ ] 应用启动时间合理（< 2s）

### 视觉测试

- [ ] 文字大小在所有设备上易于阅读
- [ ] 颜色对比度足够（WCAG AA 标准）
- [ ] 图标清晰，不模糊
- [ ] 间距一致，布局整洁
- [ ] 深色模式正常工作
- [ ] 浅色模式正常工作

## 常见问题和解决方案

### 问题 1: 横屏模式下内容被截断
**解决方案**: 使用 `Modifier.verticalScroll()` 或 `LazyColumn` 使内容可滚动

### 问题 2: 平板上卡片过大
**解决方案**: 已通过响应式网格列数解决（大平板显示 4 列）

### 问题 3: 触摸目标太小
**解决方案**: 确保所有交互元素至少 48dp，使用 `Modifier.size(48.dp)` 或更大

### 问题 4: 横竖屏切换时状态丢失
**解决方案**: 使用 ViewModel 保存状态，或使用 `rememberSaveable`

## 测试报告模板

```markdown
## 设备测试报告

**设备**: [设备名称]
**屏幕尺寸**: [宽度 x 高度]
**Android 版本**: [版本号]
**测试日期**: [日期]

### 测试结果

#### 主页
- 网格列数: [ ] 正确 [ ] 错误
- 卡片大小: [ ] 合适 [ ] 过大 [ ] 过小
- 触摸响应: [ ] 良好 [ ] 一般 [ ] 差

#### 计时器页面
- 布局方向: [ ] 正确 [ ] 错误
- 按钮大小: [ ] 合适 [ ] 过大 [ ] 过小
- 状态保持: [ ] 正常 [ ] 异常

#### 统计页面
- 热力图显示: [ ] 清晰 [ ] 模糊 [ ] 错位
- 列表滚动: [ ] 流畅 [ ] 卡顿
- 数据加载: [ ] 快速 [ ] 缓慢

### 发现的问题
1. [问题描述]
2. [问题描述]

### 建议改进
1. [改进建议]
2. [改进建议]
```

## 自动化测试

虽然本任务主要是手动测试，但可以考虑添加以下自动化测试：

```kotlin
// 示例：测试不同窗口尺寸下的网格列数
@Test
fun testGridColumnsForDifferentWindowSizes() {
    // COMPACT: 2 columns
    val compactColumns = getGridColumns(WindowSizeClass.COMPACT)
    assertEquals(2, compactColumns)
    
    // MEDIUM: 3 columns
    val mediumColumns = getGridColumns(WindowSizeClass.MEDIUM)
    assertEquals(3, mediumColumns)
    
    // EXPANDED: 4 columns
    val expandedColumns = getGridColumns(WindowSizeClass.EXPANDED)
    assertEquals(4, expandedColumns)
}
```

## 结论

完成所有测试后，确保：
1. 应用在所有目标设备上正常运行
2. 所有交互元素满足最小触摸目标要求
3. 横竖屏切换流畅，状态保持正确
4. 布局在不同屏幕尺寸下都合理美观
